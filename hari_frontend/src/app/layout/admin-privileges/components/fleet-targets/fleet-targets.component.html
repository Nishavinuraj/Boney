<div [@routerTransition]>
  <div class="row">
    <div class="col col-md-12 col-sm-12 col-xl-12 col-lg-12 scroll-h-page">
      <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
          <h4><i class="fa fa-truck"></i> Fleet Targets</h4>
        </div>
      </div>
      <hr>
      <form [formGroup]="filterForm">
        <div class="row">
          <div class="col-md-3">
            <div class="form-group">
              <label>Select Years</label>
              <select formControlName="years" class="form-control">
                <option value="">--Select--</option>
                <option *ngFor="let y of years" value="{{ y.year }}">
                  {{ y.year }}
                </option>
              </select>
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label>Select tyres</label>
              <select formControlName="tyres" class="form-control">
                <option value="">--Select--</option>
                <option *ngFor="let t of tyres" value="{{ t.name }}">
                  {{ t.name }}
                </option>
              </select>
            </div>
          </div>
          <div class="col-md-3 pull-right">
            <button (click)="fetchReport()" class="btn btn-primary" style="margin-top: 27px;">
              <i class="fa fa-get-pocket" aria-hidden="true"></i> Fetch
            </button>&nbsp;
            <button style="margin-top:26px;" (click)="refersh()" class="btn btn-warning"><i class="fa fa-refresh" aria-hidden="true"></i> Refersh </button>
          </div>
        </div>
      </form>  
      <div class="row">
          <div class="col col-md-6 col-sm-6 col-xl-6 col-lg-6">
            <!-- <ngb-pagination
              [(page)]="pagination.currenPage"
              [pageSize]="pagination.pageSize"
              [collectionSize]="pagination.total"
              [maxSize]="pagination.maxSize"
              (pageChange)="getMultiDes()"
            ></ngb-pagination> -->
          </div>
      </div>
      <form [formGroup]="editForm" class="table-overflow">
        <table class="table tableFixHead">
          <thead>
            <tr>
              <th>Truck No.</th>
              <th>Year</th>
              <th>Jan</th>
              <th>Feb</th>
              <th>March</th>
              <th>April</th>
              <th>May</th>
              <th>June</th>
              <th>July</th>
              <th>Aug</th>
              <th>Sept</th>
              <th>Oct</th>
              <th>Nov</th>
              <th>Dec</th>
              <th colspan="2">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="loading">
              <td colspan="14">
                <div class="showbox">
                  <div class="loader">
                    <svg class="circular" viewBox="25 25 50 50">
                      <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10" />
                    </svg>
                  </div>
                </div>
              </td>
            </tr>
            <tr *ngFor="let report of reports; let i = index">

              <td>{{report.truckno ? report.truckno : '--'}}</td>

              <td *ngIf="!report.updated">{{report.year ? report.year : '----'}}</td>
              <td *ngIf="report.updated">
                <select style="width:110px;" formControlName="years" class="form-control">
                  <option value="">--Select--</option>
                  <option *ngFor="let y of years" value="{{ y.year }}">
                    {{ y.year }}
                  </option>
                </select>
              </td>

              <td *ngFor="let month of report.months; let j = index">
                <span *ngIf="!report.updated"> {{month.target}}</span>
                <span *ngIf="report.updated"> 
                  <span>
                    <input type="text" [formControlName]="month.name" [placeholder]="month.name" />
                  </span>
                </span>
              </td>

              <td>
                <button (click)="edit(report, report.months)" class="btn btn-primary"><i class="fa fa-pencil"></i> Edit</button>
              </td>

              <td>
                <button *ngIf="report.updated" (click)="updateValue(report.months,report)" class="btn btn-danger">
                  <i class="fa fa-pencil-square-o"></i> Update
                </button>
              </td>
            </tr>
            <tr *ngIf="reports.length === 0">
              <td align="center" colspan="14">No data available.</td>
            </tr> 
          </tbody>
        </table>
      </form>
      <!-- <ngb-pagination
        [(page)]="pagination.currenPage"
        [pageSize]="pagination.pageSize"
        [collectionSize]="pagination.total"
        [maxSize]="pagination.maxSize"
        (pageChange)="getMultiDes()"
      ></ngb-pagination> -->
    </div>
  </div>
</div>